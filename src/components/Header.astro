---
import HeaderLink from "./HeaderLink.astro";
import { Icon } from "astro-icon/components";
import ThemeSwitch from "./ThemeSwitch.astro";

const navItems = [
  { href: "/", text: "Home" },
  { href: "/posts", text: "Posts" },
  { href: "/about", text: "About" },
  { href: "/projects", text: "Projects" },
];
---

<script>
  document.addEventListener("astro:page-load", () => {
    const openMenu = () => {
      const menu = document.getElementById("menu");
      const body = document.body;
      menu?.classList.remove("animate-fade-out");
      menu?.classList.add("animate-fade-in");
      menu?.classList.remove("hidden");
      menu?.classList.add("flex");
      body?.classList.add("overflow-hidden");
    };
    const closeMenu = () => {
      const menu = document.getElementById("menu");
      const body = document.body;
      menu?.classList.remove("animate-fade-in");
      menu?.classList.add("animate-fade-out");
      setTimeout(() => {
        menu?.classList.remove("flex");
        menu?.classList.add("hidden");
        body?.classList.remove("overflow-hidden");
      }, 200);
    };
    const menuOpen = document.getElementById("menu-open");
    const menuClose = document.getElementById("menu-close");
    menuOpen?.addEventListener("click", openMenu);
    menuClose?.addEventListener("click", closeMenu);
  });
</script>

<header
  class="bg-neutral-50 dark:bg-neutral-900 border-b border-neutral-200 dark:border-neutral-800 w-full"
>
  <div class="flex items-center justify-between p-4">
    <div>
      <a href="/" class="text-2xl font-bold mr-2 inline-block align-middle"
        >Doesmycode.work</a
      >
      <ThemeSwitch />
    </div>
    <nav class="hidden md:flex flex-row gap-4">
      {navItems.map((item) => <HeaderLink item={item} />)}
    </nav>
    <div class="flex md:hidden">
      <Icon
        id="menu-open"
        class="size-7"
        name="tabler:menu-2"
        aria-label="Open menu"
      />
      <div
        id="menu"
        class="fixed z-20 top-0 left-0 h-dvh inset-0 bg-neutral-100 dark:bg-neutral-900 flex-col gap-4 items-center justify-center hidden"
      >
        <Icon
          id="menu-close"
          class="absolute top-4 right-4 size-7"
          name="tabler:x"
          aria-label="Close menu"
        />
        {navItems.map((item) => <HeaderLink item={item} />)}
      </div>
    </div>
  </div>
</header>
