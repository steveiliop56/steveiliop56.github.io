---
const { title } = Astro.props;

const siteTitle = import.meta.env.VITE_SITE_TITLE;
const analyticsEnable = import.meta.env.VITE_ANALYTICS_ENABLE;
---

<script>
  class AstroAnalytics extends HTMLElement {
    connectedCallback() {
      const enable = this.dataset.analyticsEnable === "true";
      if (enable) {
        const umamiAttributes = {
          src: "https://analytics.doesmycode.work/script.js",
          "data-website-id": "1940b296-a8c6-4663-bcb0-0ee20a0b7c97",
        };

        const umamiScript = document.createElement("script");

        Object.entries(umamiAttributes).forEach(([key, value]) =>
          umamiScript.setAttribute(key, value),
        );

        document.head.appendChild(umamiScript);
      }
    }
  }

  customElements.get("astro-analytics") ||
    customElements.define("astro-analytics", AstroAnalytics);
</script>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<meta name="generator" content={Astro.generator} />

<meta name="description" content="My code doesn't work" />

<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="Doesmycode.work" />
<link rel="manifest" href="/site.webmanifest" />

<link
  rel="alternate"
  type="application/rss+xml"
  title="Doesmycode.work"
  href={new URL("rss.xml", Astro.site)}
/>

<astro-analytics data-analytics-enable={analyticsEnable}></astro-analytics>

<title>{title} - {siteTitle}</title>
